<%- include('partials/header') %>
<h1>JAX DELIVERY</h1>
<div class="grid three">
  <div class="card stat"><div class="label">Total COD attendu</div><div class="value"><%= totals.expected %> TND</div></div>
  <div class="card stat"><div class="label">Total payé</div><div class="value"><%= totals.paid %> TND</div></div>
  <div class="card stat"><div class="label">Reste à payer</div><div class="value"><%= totals.remaining %> TND</div></div>
</div>
<div class="grid two">
  <div class="card">
    <h3>Ajouter un paiement</h3>
    <form method="POST" action="/jax/payments">
      <label>Date
        <input type="date" name="date" value="<%= new Date().toISOString().slice(0,10) %>">
      </label>
      <label>Montant (TND)
        <input type="number" step="0.01" name="amount" required>
      </label>
      <label>Note
        <input type="text" name="note">
      </label>
      <button type="submit">Enregistrer</button>
    </form>
  </div>
  <div class="card">
    <h3>Paiements passés</h3>
    <table class="table">
      <thead>
        <tr><th>Date</th><th>Montant</th><th>Note</th></tr>
      </thead>
      <tbody>
        <% payments.forEach(p => { %>
          <tr>
            <td><%= p.date %></td>
            <td><%= p.amount_display.toFixed(2) %> TND</td>
            <td><%= p.note || '' %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>
<%- include('partials/footer') %>
